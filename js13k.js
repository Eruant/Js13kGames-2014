function SfxrParams(){this.setSettings=function(e){for(var t=0;24>t;t++)this[String.fromCharCode(97+t)]=e[t]||0;this.c<.01&&(this.c=.01);var n=this.b+this.c+this.e;if(.18>n){var a=.18/n;this.b*=a,this.c*=a,this.e*=a}}}function SfxrSynth(){this._params=new SfxrParams;var e,t,n,a,i,s,r,o,h,d,c,v;this.reset=function(){var e=this._params;a=100/(e.f*e.f+.001),i=100/(e.g*e.g+.001),s=1-e.h*e.h*e.h*.01,r=-e.i*e.i*e.i*1e-6,e.a||(c=.5-e.n/2,v=5e-5*-e.o),o=1+e.l*e.l*(e.l>0?-.9:10),h=0,d=1==e.m?0:(1-e.m)*(1-e.m)*2e4+32},this.totalReset=function(){this.reset();var a=this._params;return e=a.b*a.b*1e5,t=a.c*a.c*1e5,n=a.e*a.e*1e5+12,3*((e+t+n)/3|0)},this.synthWave=function(u,l){var p=this._params,f=1!=p.s||p.v,w=p.v*p.v*.1,y=1+3e-4*p.w,g=p.s*p.s*p.s*.1,m=1+1e-4*p.t,k=1!=p.s,E=p.x*p.x,b=p.g,I=p.q||p.r,A=p.r*p.r*p.r*.2,L=p.q*p.q*(p.q<0?-1020:1020),S=p.p?((1-p.p)*(1-p.p)*2e4|0)+32:0,x=p.d,G=p.j/2,C=p.k*p.k*.01,M=p.a,q=e,O=1/e,_=1/t,j=1/n,K=5/(1+p.u*p.u*20)*(.01+g);K>.8&&(K=.8),K=1-K;for(var T,U,P,R,W,B,F=!1,N=0,z=0,D=0,H=0,J=0,Q=0,V=0,X=0,Y=0,Z=0,$=new Array(1024),et=new Array(32),tt=$.length;tt--;)$[tt]=0;for(var tt=et.length;tt--;)et[tt]=2*Math.random()-1;for(var tt=0;l>tt;tt++){if(F)return tt;if(S&&++Y>=S&&(Y=0,this.reset()),d&&++h>=d&&(d=0,a*=o),s+=r,a*=s,a>i&&(a=i,b>0&&(F=!0)),U=a,G>0&&(Z+=C,U*=1+Math.sin(Z)*G),U|=0,8>U&&(U=8),M||(c+=v,0>c?c=0:c>.5&&(c=.5)),++z>q)switch(z=0,++N){case 1:q=t;break;case 2:q=n}switch(N){case 0:D=z*O;break;case 1:D=1+2*(1-z*_)*x;break;case 2:D=1-z*j;break;case 3:D=0,F=!0}I&&(L+=A,P=0|L,0>P?P=-P:P>1023&&(P=1023)),f&&y&&(w*=y,1e-5>w?w=1e-5:w>.1&&(w=.1)),B=0;for(var nt=8;nt--;){if(V++,V>=U&&(V%=U,3==M))for(var at=et.length;at--;)et[at]=2*Math.random()-1;switch(M){case 0:W=c>V/U?.5:-.5;break;case 1:W=1-V/U*2;break;case 2:R=V/U,R=6.28318531*(R>.5?R-1:R),W=1.27323954*R+.405284735*R*R*(0>R?1:-1),W=.225*((0>W?-1:1)*W*W-W)+W;break;case 3:W=et[Math.abs(32*V/U|0)]}f&&(T=Q,g*=m,0>g?g=0:g>.1&&(g=.1),k?(J+=(W-Q)*g,J*=K):(Q=W,J=0),Q+=J,H+=Q-T,H*=1-w,W=H),I&&($[X%1024]=W,W+=$[(X-P+1024)%1024],X++),B+=W}B*=.125*D*E,u[tt]=B>=1?32767:-1>=B?-32768:32767*B|0}return l}}var synth=new SfxrSynth;window.jsfxr=function(e){synth._params.setSettings(e);var t=synth.totalReset(),n=new Uint8Array(4*((t+1)/2|0)+44),a=2*synth.synthWave(new Uint16Array(n.buffer,44),t),i=new Uint32Array(n.buffer,0,44);i[0]=1179011410,i[1]=a+36,i[2]=1163280727,i[3]=544501094,i[4]=16,i[5]=65537,i[6]=44100,i[7]=88200,i[8]=1048578,i[9]=1635017060,i[10]=a,a+=44;for(var s=0,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o="data:audio/wav;base64,";a>s;s+=3){var h=n[s]<<16|n[s+1]<<8|n[s+2];o+=r[h>>18]+r[h>>12&63]+r[h>>6&63]+r[63&h]}return o};var ArcadeAudio=function(){this.sounds={}};ArcadeAudio.prototype.add=function(e,t,n){this.sounds[e]=[],n.forEach(function(n,a){this.sounds[e].push({tick:0,count:t,pool:[]});for(var i=0;t>i;i++){var s=new Audio;s.src=jsfxr(n),this.sounds[e][a].pool.push(s)}},this)},ArcadeAudio.prototype.play=function(e){var t=this.sounds[e],n=t.length>1?t[Math.floor(Math.random()*t.length)]:t[0];n.pool[n.tick].play(),n.tick=n.tick<n.count-1?n.tick+1:0},window.raf=function(){return window.requestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();var Game=function(){var e=window.document;this.canvas=e.createElement("canvas"),this.canvas.width=300,this.canvas.height=300,this.fps=1e3/60,this.ctx=this.canvas.getContext("2d"),e.getElementsByTagName("body")[0].appendChild(this.canvas),this.io=new IO(this.canvas,this),this.io.delegate=this,this.io.addEvents(),this.io.activeInput={earth:!1,water:!1,air:!1,fire:!1,up:!1,down:!1,left:!1,right:!1};var t=new ArcadeAudio;t.add("powerup",10,[[0,,.01,,.4384,.2,,.12,.28,1,.65,,,.0419,,,,,1,,,,,.3]]),t.play("powerup")};Game.prototype.start=function(){var e=this;this.interval=window.setInterval(function(){e.update()},this.fps),this.tick()},Game.prototype.pause=function(){window.clearInterval(this.interval),delete this.interval},Game.prototype.update=function(){},Game.prototype.render=function(){},Game.prototype.tick=function(){this.interval&&(this.render(),window.raf(this.tick.bind(this)))},Game.prototype.handleEvent=function(e){switch(e.type){case"keydown":console.log("key down"),this.setKeyState(e.keyCode,!0);break;case"keyup":console.log("key up"),this.setKeyState(e.keyCode,!1)}},Game.prototype.setKeyState=function(e,t){switch(e){case 49:this.io.activeInput.earth=t;break;case 50:this.io.activeInput.water=t;break;case 51:this.io.activeInput.air=t;break;case 52:this.io.activeInput.fire=t;break;case 37:this.io.activeInput.left=t;break;case 39:this.io.activeInput.right=t;break;case 38:this.io.activeInput.up=t;break;case 40:this.io.activeInput.down=t}};var IO=function(e){this.el=e,this.ongoingTouches=[],this.delegate=this};IO.prototype.addEvents=function(){this.el.addEventListener("touchstart",this.delegate.handleEvent,!1),this.el.addEventListener("touchmove",this.delegate.handleEvent,!1),this.el.addEventListener("touchend",this.delegate.handleEvent,!1),this.el.addEventListener("touchcancel",this.delegate.handleEvent,!1),window.addEventListener("keydown",this.delegate.handleEvent.bind(this.delegate),!0),window.addEventListener("keyup",this.delegate.handleEvent.bind(this.delegate),!0)},IO.prototype.removeEvents=function(){this.el.removeEventListener("touchstart",this.delegate.handleEvent,!1),this.el.removeEventListener("touchmove",this.delegate.handleEvent,!1),this.el.removeEventListener("touchend",this.delegate.handleEvent,!1),this.el.removeEventListener("touchcancel",this.delegate.handleEvent,!1),window.removeEventListener("keydown",this.delegate.handleEvent.bind(this.delegate),!0),window.removeEventListener("keyup",this.delegate.handleEvent.bind(this.delegate),!0)},IO.prototype.handleEvent=function(){},window.onload=function(){var e=new Game(300,300);e.start()};